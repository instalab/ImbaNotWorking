var Imba = require('imba'), _1 = Imba.createElement;
var Menu = require('uxa').Menu;

var EditorMenu = Imba.defineTag('EditorMenu', Menu, function(tag){
	
	tag.prototype.mount = function (){
		this.dom().focus();
		return this.schedule({events: true});
	};
	
	tag.prototype.space = function (){
		return this.data().space();
	};
	
	tag.prototype.onfocusout = function (e){
		if (!this.dom().contains(e.native().relatedTarget)) {
			return this.trigger('uxa:hide');
		};
	};
	
	tag.prototype.render = function (){
		var $ = this.$;
		let mac = this.api().ua().isMac();
		return this.$open(0).setTabindex(-1).setChildren($.$ = $.$ || [
			_1('div',$,0,this).flag('field').flag('range').setContent([
				_1('input',$,1,0).setType('range').setMin(8).setStep(1).setMax(24).setNumber(true),
				_1('label',$,2,0).setContent([
					_1('span',$,3,2).setText("Font Size"),
					_1('span',$,4,2).flag('value')
				],2)
			],2),
			_1('hr',$,5,this),
			_1('div',$,6,this).flag('item').setText("reload browser"),
			_1('div',$,7,this).flag('item').setText("show/hide browser")
		],2).synced((
			$[1].bindData(this.space().view(),'userFontSize',[]).end(),
			$[4].setContent(this.space().view().fontSize() + 'px',3),
			$[6].dataset('shortcut',(mac ? 'cmd+s' : 'ctrl+s')).end(),
			$[7].dataset('shortcut',(mac ? 'cmd+b' : 'ctrl+b')).end()
		,true));
	};
})
exports.EditorMenu = EditorMenu;
