var self = {};

var highlighter = require('highlight.js/lib/highlight.js');

var hlimba = require('../util/hljs-imba.js');
var hljs = require('highlight.js/lib/languages/javascript.js');
var hlts = require('highlight.js/lib/languages/typescript.js');
var hlhtml = require('highlight.js/lib/languages/xml.js');
var hlcss = require('highlight.js/lib/languages/css.js');
var hlsass = require('highlight.js/lib/languages/scss.js');
var hljson = require('highlight.js/lib/languages/json.js');
var hlmarkdown = require('highlight.js/lib/languages/markdown.js');

// "json", "less", "scss", "typescript", "xml"
highlighter.registerLanguage('javascript',hljs);
highlighter.registerLanguage('typescript',hlts);
highlighter.registerLanguage('html',hlhtml);
highlighter.registerLanguage('css',hlcss);
highlighter.registerLanguage('sass',hlsass);
highlighter.registerLanguage('json',hljson);
highlighter.registerLanguage('imba',hlimba);
highlighter.registerLanguage('markdown',hlmarkdown);

highlighter.configure({classPrefix: 'tok-'});

exports.highlight = self.highlight = function (code,lang){
	
	if (lang) {
		if (!highlighter.getLanguage(lang)) { return code };
		return highlighter.highlight(lang,code).value;
	} else {
		return highlighter.highlightAuto(code).value;
	};
};
