var Imba = require('imba');

var Actionable = Imba.defineTag('Actionable', function(tag){
	
	tag._flagName = null;
	
	tag.prototype.action = function(v){ return this._action; }
	tag.prototype.setAction = function(v){ this._action = v; return this; };
	
	tag.prototype.contextData = function (){
		var data = null;
		var el = this;
		while (el){
			if (data = el.data()) {
				return data;
			};
			el = el.parent();
		};
		return null;
	};
	
	tag.prototype.ontap = function (e){
		var action = this.action();
		
		if (action) {
			this.trigger("uxa:action",action);
		};
		
		if ((typeof action=='string'||action instanceof String)) {
			e.halt().silence();
			this.trigger(action,this.contextData());
		} else if (action instanceof Array) {
			e.halt().silence();
			this.trigger(action[0],action.slice(1));
		} else {
			e._responder = null;
		};
		return this;
	};
})
exports.Actionable = Actionable;
