var Imba = require('imba'), _1 = Imba.createElement;
var uxa$ = require('uxa'), Dialog = uxa$.Dialog, TextField = uxa$.TextField;

var desc = 'You can assign specific version with "@", ex. "react@0.14.7" or "react@next"';

var DependencyAddDialog = Imba.defineTag('DependencyAddDialog', Dialog, function(tag){
	
	tag.prototype.mount = function (){
		this.schedule({events: true});
		return this._packageName.input().dom().focus();
	};
	
	tag.prototype.space = function (){
		return this.data();
	};
	
	tag.prototype.submitLabel = function (){
		return "Add";
	};
	
	tag.prototype.bundle = function (){
		return this.space().browser().npmPackages() || {resolved: []};
	};
	
	tag.prototype.body = function (){
		let $ = this.$$ || (this.$$ = {}), t0;
		return (t0 = this._body = this._body||(t0=_1('div',this)).flag('body').setContent([
			_1('h2',t0.$,'A',t0).setText("Add NPM package"),
			this._packageName = this._packageName||_1(TextField,t0).flag('packageName').setLabel("Package name").setName('query').setPlaceholder('Submit name of package...').setAutocomplete("off")
		],2)).end((
			this._packageName.setDesc(desc).end()
		,true));
	};
	
	
	tag.prototype.onuxasubmit = function (e,pars){
		var self = this;
		e.prevent().halt();
		if (!pars.query) {
			return;
		};
		
		return self.uxa().queue().add(300,async function() {
			await self.space().browser().addPackage(pars.query);
			return self.hide();
		});
	};
})
exports.DependencyAddDialog = DependencyAddDialog;
