var Imba = require('imba'), _1 = Imba.createElement;
var Dialog = require('uxa').Dialog;
var LongPromise = require('../../util/LongPromise').LongPromise;

var util = require('../util');

// TODO think through new dialog showing progress during finish etc
var RecDoneDialog = Imba.defineTag('RecDoneDialog', Dialog, function(tag){
	
	tag.prototype.body = function (){
		let $ = this.$$ || (this.$$ = {}), t0;
		return (t0 = this._body = this._body||(t0=_1('div',this)).flag('body').setContent([
			_1('h1',t0.$,'A',t0).setText('Scrimcast ended'),
			_1('p',t0.$,'B',t0).setText('Do you want to save a recording of the session?')
		],2));
	};
	
	tag.prototype.dismissLabel = function (){
		return "Discard";
	};
	
	tag.prototype.confirmLabel = function (){
		return "Save recording";
	};
	
	tag.prototype.onuxadismiss = function (){
		var self = this;
		return self.uxa().queue().add(300,function() {
			return self.data().discard();
		});
	};
	
	tag.prototype.onuxasubmit = function (){
		var self = this;
		return self.uxa().queue().add(5000,function() { return self.data().finish(); });
	};
})
exports.RecDoneDialog = RecDoneDialog;
