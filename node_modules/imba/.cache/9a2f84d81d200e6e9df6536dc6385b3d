var Imba = require('imba'), _1 = Imba.createElement;
var Menu = require('uxa').Menu;

var EditorMenu = Imba.defineTag('EditorMenu', Menu, function(tag){
	
	tag.prototype.mount = function (){
		this.dom().focus();
		return this.schedule({events: true});
	};
	
	tag.prototype.space = function (){
		return this.data().space();
	};
	
	tag.prototype.onfocusout = function (e){
		if (!this.dom().contains(e.native().relatedTarget)) {
			return this.trigger('uxa:hide');
		};
	};
	
	tag.prototype.render = function (){
		var $ = this.$;
		let mac = this.api().ua().isMac();
		return this.$open(0).flag('space-menu').setTabindex(-1).setChildren($.$ = $.$ || [
			// <.item>
			// 	<label>
			// 		<span> "Speed"
			// 		<span.value> data.playbackRate.toFixed(1) + 'x'
			// 	<input[data.playbackRate] type='range' min=0.4 step=0.1 max=2 number=yes>
			_1('div',$,0,this).flag('item').setContent([
				_1('label',$,1,0).setContent([
					_1('span',$,2,1).setText("Font Size"),
					_1('span',$,3,1).flag('value')
				],2),
				_1('input',$,4,0).setType('range').setMin(8).setStep(1).setMax(24).setNumber(true)
			],2),
			_1('div',$,5,this).flag('item').setContent([
				_1('label',$,6,5).setText("Shortcuts"),
				_1('div',$,7,5).flag('shortcut').setText("reload browser"),
				_1('div',$,8,5).flag('shortcut').setText("show/hide browser")
			],2)
		],2).synced((
			$[3].setContent(this.space().view().fontSize() + 'px',3),
			$[4].bindData(this.space().view(),'userFontSize',[]).end(),
			$[7].dataset('shortcut',(mac ? 'cmd+s' : 'ctrl+s')).end(),
			$[8].dataset('shortcut',(mac ? 'cmd+b' : 'ctrl+b')).end()
		,true));
	};
})
exports.EditorMenu = EditorMenu;
