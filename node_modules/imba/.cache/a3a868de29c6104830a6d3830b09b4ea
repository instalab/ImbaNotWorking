var Imba = require('imba');
var Tile = Imba.defineTag('Tile', function(tag){
	
	tag.reg = function (type){
		return Tile[type] = this;
	};
	
	tag.prototype.options = function(v){ return this._options; }
	tag.prototype.setOptions = function(v){ this._options = v; return this; };
	
	tag.prototype.isSelectable = function (){
		return this.options() && this.options().selectable;
	};
	
	tag.prototype.isTappable = function (){
		return true;
	};
	
	tag.prototype.url = function (){
		return "";
	};
	
	tag.prototype.ontap = function (e){
		if (this.isSelectable()) {
			this.trigger('tileselect',this);
			return e.stop();
		};
		
		if (this.isTappable() && this.url()) {
			if (e.meta() || e.alt()) {
				window.open(this.url());
			} else {
				this.router().go(this.url());
			};
			return e.stop();
			// trigger('castopen',[data,playlist])
		};
	};
	
	tag.prototype.beforeRender = function (){
		if (!(this.data() && this.data().v > 0 && (!this.data().CODE || this.data().CODE == 200))) { return false };
		return true;
	};
})
exports.Tile = Tile;
