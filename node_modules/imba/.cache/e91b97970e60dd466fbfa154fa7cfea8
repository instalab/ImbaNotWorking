var Imba = require('imba'), _1 = Imba.createElement;
var PaneView = Imba.defineTag('PaneView', 'section', function(tag){
	
	tag.prototype.__title = {'default': "Pane",name: 'title'};
	tag.prototype.title = function(v){ return this._title; }
	tag.prototype.setTitle = function(v){ this._title = v; return this; }
	tag.prototype._title = "Pane";
	tag.prototype.key = function(v){ return this._key; }
	tag.prototype.setKey = function(v){ this._key = v; return this; };
	
	tag.prototype.build = function (){
		this.setTabindex(0);
		return tag.prototype.__super__.build.apply(this,arguments);
	};
	
	tag.prototype.oncontextmenu = function (e){
		var menu;
		e.prevent().halt();
		if (menu = this.contextmenu()) {
			return menu.showAt(e.x(),e.y());
		};
	};
	
	tag.prototype.contextmenu = function (){
		return null;
	};
	
	tag.prototype.onfocusin = function (e){
		var v_;
		e.halt();
		
		if (this.data().space().cursor().canPush()) {
			return (this.data().space().agent().setFocus(v_ = this.data()),v_);
		};
	};
	
	tag.prototype.onfocusout = function (e){
		// console.log 'Pane.onfocusout',e.event:relatedTarget
		var v_;
		e.halt();
		if (!e.event().relatedTarget) {
			if (this.data().space().cursor().canPush()) {
				return (this.data().space().agent().setFocus(null),null);
			};
		};
	};
	
	tag.prototype.header = function (){
		return null;
	};
	tag.prototype.footer = function (){
		return null;
	};
	tag.prototype.body = function (){
		let $ = this.$$ || (this.$$ = {});
		return (this._body = this._body||_1('div',this).flag('body')).setText("Content of pane " + this.title());
	};
	
	tag.prototype.render = function (){
		return this.$open(0).setChildren([
			this.header(),
			this.body(),
			this.footer()
		],1).synced();
	};
})
exports.PaneView = PaneView;
