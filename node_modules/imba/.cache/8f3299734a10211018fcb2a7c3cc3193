var self = {};
if (true) {
	var custom = require('../env.json');
	var fallback = require('../env.example.json');
	var path = require('path');
};

var root = __dirname + '/..';

var cached = {};

exports.get = self.get = function (key){
	var value = cached[key];
	
	if (!custom[key] && fallback[key]) {
		console.warn(("ENV variable " + key + " is only found in env.example.json"));
	};
	
	value || (value = process.env[key] || custom[key] || fallback[key]);
	
	if (/^\.\//.test(value)) {
		value = path.resolve(root,value);
	};
	
	return cached[key] || (cached[key] = value);
};

exports.set = self.set = function (key,value){
	cached[key] = value;
	return null;
};


var port = Number(self.get('PORT') || 8000);
self.get('NGINX_PORT') || self.set('NGINX_PORT',port);
self.get('SITE_PORT') || self.set('SITE_PORT',port + 1);
self.get('YAAS_PORT') || self.set('YAAS_PORT',port + 2);
