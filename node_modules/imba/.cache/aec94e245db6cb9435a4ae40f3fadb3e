var Imba = require('imba'), _1 = Imba.createElement;
var Select = Imba.defineTag('Select', 'select', function(tag){
	tag.prototype.__data = {watch: 'dataDidSet',name: 'data'};
	tag.prototype.data = function(v){ return this._data; }
	tag.prototype.setData = function(v){
		var a = this.data();
		if(v != a) { this._data = v; }
		if(v != a) { this.dataDidSet && this.dataDidSet(v,a,this.__data) }
		return this;
	};
	
	tag.prototype.dataDidSet = function (val){
		return this._newValue = val;
	};
	
	tag.prototype.commit = function (){
		tag.prototype.__super__.commit.apply(this,arguments);
		if (this._newValue != undefined) {
			this.dom().value = this._newValue;
			this._newValue = undefined;
		};
		return this;
	};
	
	tag.prototype.value = function (){
		var val = tag.prototype.__super__.value.apply(this,arguments);
		return (val == '--') ? null : val;
	};
})
exports.Select = Select;


var Radio = Imba.defineTag('Radio', 'label', function(tag){
	tag.prototype.desc = function(v){ return this._desc; }
	tag.prototype.setDesc = function(v){ this._desc = v; return this; };
	tag.prototype.name = function(v){ return this._name; }
	tag.prototype.setName = function(v){ this._name = v; return this; };
	tag.prototype.value = function(v){ return this._value; }
	tag.prototype.setValue = function(v){ this._value = v; return this; };
	tag.prototype.label = function(v){ return this._label; }
	tag.prototype.setLabel = function(v){ this._label = v; return this; };
	
	tag.prototype.render = function (){
		var $ = this.$;
		return this.$open(0).setChildren($.$ = $.$ || [
			_1('input',$,0,this).setType("radio"),
			_1('span',$,1,this).flag('radio')
		],2).synced((
			$[0].setName(this.name()).setValue(this.value(),1).end(),
			$[1].setContent([
				($[2] || _1('span',$,2,1).flag('radio-icon')),
				this.label() ? (
					($[3] || _1('span',$,3,1).flag('label')).setContent(this.label(),3)
				) : void(0),
				this.desc() ? (
					($[4] || _1('span',$,4,1).flag('desc')).setContent(this.desc(),3)
				) : void(0)
			],1)
		,true));
	};
})
exports.Radio = Radio;

var Option = Imba.defineTag('Option', function(tag){
	tag.prototype.value = function(v){ return this._value; }
	tag.prototype.setValue = function(v){ this._value = v; return this; };
	tag.prototype.label = function(v){ return this._label; }
	tag.prototype.setLabel = function(v){ this._label = v; return this; };
	
	tag.prototype.render = function (){
		return this.$open(0).setChildren(this.label() || this.value(),3).synced();
	};
});
